
# CHOIX DU TERMINAL GRAPHIQUE ::

# echo M # si mate-terminal
# echo X # si xterm
# echo G # si gnome-terminal
# echo K # si konsole
# echo T # si terminator

# DEBUG EN COURS ::
# creer pour chaque ecran, une liste de fenetre Taggees pour collecter
# leur PID plus tard :: les killer en groupe devient + simple ...

# pb de Portabilite et "cohabitation" xterm et less :: --mouse permet scroll, 
# mais plante le \n de selection en xclip !!! :: la syllabe de selection doit
# etre suffisamment "riche" pour un resultat en 1 page !!!
# OU :: tester more !! :: le scroll back pas necessaire ?? ...
# OU :: detecter l'exces de lignes, et paginer "a la main" ??
# OU :: un PS1='';clear;tput civis;grep SYL FIC permet un scroll sans less !!
#----- U :: PROCEDURE DE RECHERCHE ET DE LANCEMENT DU FILM -------------
# C=`~/TERM`  # choix de la Console Graphique

#flags de Synchro et data temporaire dans repertoire $F ::
# BUGS avec Rtou, trop violent au kill ?? :: peut tuer dd de microsd !!
# clafUP :: presence full clavier alpha
# mpvUP :: Fichier,taille 0-1 :: le film est en Cours de lecture ..., UP a 
      # msg_mpv par UL, DOWN fin mpv, au msg_retir :: un Reset Rtou doit DOWN
# F :: synchro avec TL ??
# ECHO :: echo brut en plusieurs lignes 
# ECHOL :: echo en 1 seule ligne
# PP :: numero de film de la microsd, frappe au clavier numeriq vertical
# ulPID :: liste tous les PID de UL
# ulPID2 :: liste tous les autres ? PID de UL
# ECHO2 :: choix du MENU 1,2,3 apres proc 'sel' ... puis dans variable SE
# zl :: liste tous les films Collection
# FINIOUINON :: Fichier flag de Boucle sur recherch TOUS les films
# OUI, NON  :: fichier reponse vers recherch TOUS film en clavier alpha
# Rtou :: Reset complet !!, si Pb
# FINISYL :: fichier flag de syllabe complete apres clavier alpha
# lism :: liste des films microsd
# lism2 :: liste des films microsd, numerotes avec numero uniq
# lism3 :: ligne du film selectionnee extraite de microsd
# lism4 :: nom du film selectionne sur microsd, puis variable FI
# SD_UNMONTED :: etat de Montage de la microsd
# SE :: choix du MENU
 
# selPID :: PIDs pour futur RESET trop ou pas assez violent ?
# tous les Menus sont ecrits pour du 1080p, meme sur un ecran 4K ou 8K
# seul mpv pourrait afficher en 4K ou 8K ...
# >FF;>TT; pas present dans cette Proc 'sel'
# ECHO, ECHO2 :: fichier de travail de l'Echo
# RselF :: flag de Synchro du Reset 'Rsel' de la proc 'sel' 
  
# NOTES DE PORTAGE ::
# -DEPENDANCES :: scroll texte avec souris (less), Player (mpv), xclip (copier
# coller X11), terminal graphique (mate-terminal, xterm), format du ps-ef? ...
# -Pour ajuster les affichages en 'less', jouer a la fois sur le zoom de less,
# ET sur le profile par defaut du terminal graphique ... ici mate-terminal ...
# en xterm, jouer sur la fs -FontSize suffit !!
# -en 1080p en force ! sur moniteur 2K, 4K, ou 8K :: positionnements inchanges
# -pour apt et terminal graphique, activer les sites NON Canonical ...
# -etc/sudoers :: marco ALL=(ALL:ALL) NOPASSWD:ALL, et rm passwd marco shadow
# -on armbian, use armbian-config for grXaphic login ...
# -dans .profile, procedure SON en & :: /home/marco/S & :: gagne 20s au boot !!!
# ajouter aussi :: ( sleep 20; /home/marco/TL ) & ...
# portabilite de la syntaxe & de less, pour recherche selective dans collection?

#flags de Synchro et data temporaire dans repertoire $F ::
# les Flags Variables Shell ne sont pas maintenus en Reset par Exec TL ...
# mais les Flags Fichiers le sont ...
# noter Dir, et moments UP, puis DOWN, puis Proc qui les utilisent ...

# PROCEDURE DE DEMARRAGE DE LA BOX MULTIMEDIA ... ET GESTION MICROSD
# BOOTDEV pour l'ordre des BlockDEV au Boot ...
# F :: ?? entre TL et UL
# NEWSD :: nouvelle microsd detectee 1ere fois ??
# clafUP :: hors full clavier alpÄ¥a ...
# mpvUP :: hors mpv, Fichier, pas TL,
# SD_UNMOUNTED :: etat du montage microsd ...
# CHKless, CHKmpv, CHKdd :: flags de Presence ..., control relance UL, testSD
# ECHOL :: texte saisi en 1 seule ligne, 
# TRACE pour stocker des Traces en Debug
# SP :: /dev/sdx de la microsd 
# PARTED, Parted :: taille en Octet de la microsd
# affiner les Kill des procedures de Reset ... et d'effacement de menus ... ::
# ils peuvent tuer dd de microsd !!
# tester microsd FAT32, et ... reparer !
# remettre a 0 auto, le testSDcur en fin de microsd
#
###############################################################################
# TESTS ARRACHAGE MicroSD ::
# si USER arrache la cle USB, on le repere dans "ddError", dans le repertoire
# _x_y ... On le voit aussi, car "testSDcur" s'arrete ...
# Si on demonte /m, et qu'on lui demande de rebrancher la cle, tout
# est OK ... sinon, sans demonter, rebrancher la cle cree /dev/sdb, au lieu 
# /dev/sda, et rien ne fonctionne ...
#
# SI le remount ne marche pas, alors explorer la detection /dev/sdx, puis la 
# FAT32 ...
#
# Sortir ma microsd, directement en laissant la cle USB, ne fait pas 
# disparaitre /dev/sda, mais seulement /dev/sda1 !!
# En re-inserant la microsd, tout repart !!!
# Tant qu'on n'ecrit pas sur la microsd, ca reste propre ??...
# Un arrachage pendant mpv l'arrete, et il sort une erreur ... 
# Mais en re-inserant la microsd, on peut redemarrer le film !!! ... ::
# il reste mounted normalement !!!, car rien n'a ete ecrit ???
# Et si on change de microsd, ca plante ???, car FAT differente ...
#
# Si detection d'arrachage, faire umount /m et attendre ... !!!, meme pas 
# besoin de savoir si c'est cle USB ou microsd seule ...
# puis reprendre un cycle du debut pour remonter ...
#
##############################################################################
# le PLAYER ..... une grosse dependance ...... ::
#
# Tentative avec ArchDroid sur Odroid C4 ... ::
# dans /boot/boot.ini, corriger governor='performance'
# mpv est presque bon !!! :: seuls les moments "difficiles" de ace* (le zoom
# sur la montagne final) sautillent ... Des Drop frames ont lieu avant, mais
# peu visibles ... une resolution Ecran 720p lisse un peu ...
# kodi n'est pas trouve a l'install ??!!! (pacman -S kodi-x11)
#
# Sur Armbian, installer kodi OK !!, ... mais il manque libvdpau_meson.so pour 
# l acceleration hardw ... ??
#
#  Penser a utiliser un accelerateur Hardw EXTERNE, pour etre moins dependant
#  dans la Box ??? ...
#  En 4K, 8K, les TVs auront une prise USB; ou un Remore FilSys en Ethernet, 
#  pour lire le film en externe, et avec LEUR accel Hardw interne ...
#
#  Dont un Odroid C2 !!!, en LibrElec qui fait de la belle 4K, AVEC son accel Hard ...
#  Peut-on acceder en LibrElec, a un serveur Video (ma Box) en Wifi ou Ether ??
#  ou USB a USB ??
#  Comment gerer les 2 entrees HDMI des 2 box sur la tele ...??? Switch HDMI ???
#
# Les prochaines box pi5:OdroiC5 auront assez de CPU en 2K, sans accel Hard, ...
# mais en 4K ????, ou 8K
#
# Sur PI4, le pilote video est dans le kernel KMS ??? ... ca accelere ???
#  en mode Legacy, le film ace* saute sans arret !!!, meme a 2GHz
#  en mode KMS 128M, 1.5GHz suffit ... FKMS 512M pas convainquant ...
#  KMS tres efficace !!! :: A-V 0 en mpv, et frame drop =0 !!!
#
# apparemment, pas de KMS sur Budgie C4 ..., seulement sur PI4
#####################################################################
## Config settings specific to arm64 sur Budgi Pi4
#arm_64bit=1
#dtoverlay=dwc2
#gpu_mem=128
#dtoverlay=vc4-kms-v3d
#arm_freq=1800
#over_voltage=3
#[pi4]
#max_framebuffers=2
#arm_boost=1
####################################################################
## lsmod autour de KMS, et de ses modules ....::
#drm_kms_helper        344064  3 vc4
#cec                    81920  2 drm_kms_helper,vc4
#fb_sys_fops            20480  1 drm_kms_helper
#syscopyarea            16384  1 drm_kms_helper
#sysfillrect            20480  1 drm_kms_helper
#sysimgblt              16384  1 drm_kms_helper
#drm                   651264  10 gpu_sched,drm_kms_helper,v3d,vc4
#vc4                   344064  30
#snd_soc_core          311296  2 vc4,snd_soc_hdmi_codec
#drm_kms_helper        344064  3 vc4
#cec                    81920  2 drm_kms_helper,vc4
#drm                   651264  10 gpu_sched,drm_kms_helper,v3d,vc4
#v3d                    94208  3
#gpu_sched              49152  1 v3d
#drm                   651264  10 gpu_sched,drm_kms_helper,v3d,vc4
####################################################################
#
# comment fonctionnerait LibrElec de Odroid C4 !!!, en VM linux ???
# Trouver une VM ARM !!! sur C4 ... (ou C2) ??
#
